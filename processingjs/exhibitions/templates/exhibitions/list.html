{% extends "base.html" %}
{% load dict_filters %}
{% block extras %}
{% load staticfiles %}
<script type="text/javascript" src="{% static "js/artwork-render.js" %}"></script>
<script type="text/javascript" src="{% static "js/vote.js" %}"></script>
{% endblock %}
{% block content %}
{% load rulez_perms %}
{% rulez_perms can_save model as USER_CAN_SAVE %}
<div id="exhibition-list-content">

{% if USER_CAN_SAVE %}
<div class="columns">
    <form class="link" method="get" action="{% url 'exhibition-add' %}">
        <button id="exhibition-add" type="submit" class="button tiny"
            title="create new exhibition"><i class="fa fa-plus"> Exhibition</i></button>
    </form>
</div>
{% endif %}

<div class="columns small-12">
{% for exhibition in object_list %}
<div class="exhibition row">
<div class="exhibition-detail columns small-2 medium-3">
    {% if exhibition.image %}
    <a href="{% url 'exhibition-view' exhibition.id %}" title="Click to view {{ exhibition.title }}">
        <img class="exhibition-image" src="{{ exhibition.image.url }}" alt="{{ exhibition.title }}" />
    </a>
    {% endif %}
    <h4 class="exhibition-title"><a href="{% url 'exhibition-view' exhibition.id %}">{{ exhibition.title }}</a></h4>
    {% if not exhibition.released_yet %}
    <div class="not-available">Release date <time>{{ exhibition.released_at|date }} {{ exhibition.released_at|time }}</time></div>
    {% endif %}
    <div class="exhibition-description">{{ exhibition.description|truncatechars:100 }}</div>
    <div class="exhibition-link"><a href="{% url 'exhibition-view' exhibition.id %}">all artwork</a></div>
</div>

<div class="exhibition-submissions columns small-10 medium-9">
{% with submission_list|get:exhibition.id as submissions %}
{% include 'submissions/_list.html' with object_list=submissions.object_list votes=submissions.votes page_obj=submissions.page_obj exhibition_id=exhibition.id order=submissions.order %}
{% endwith %}
</div>

</div>
{% endfor %}
</div>

</div>
{% include 'django_adelaidex_lti/disqus_count.html' %}
{% endblock content %}

